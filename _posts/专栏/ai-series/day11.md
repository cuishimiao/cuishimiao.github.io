---
title: "ä½ çš„æ–‡ç« æ ‡é¢˜"
date: 2024-03-20  # â† å¿…é¡»åŒ…å«æ—¥æœŸå­—æ®µ
series: "AIå­¦ä¹ ä¹‹è·¯"  # â† ç³»åˆ—æ ‡è¯†ç¬¦éœ€å®Œå…¨ä¸€è‡´
permalink: /ä¸“æ /ai-series/:title/  # â† è‡ªå®šä¹‰URLç»“æ„
---
# Day11 :RNNä¸åºåˆ—æ¨¡å‹(LSTMé—¨æ§æœºåˆ¶ï¼ˆæ—¶åºé¢„æµ‹æ¡ˆä¾‹ï¼‰)




ğŸš€ **LSTMï¼šå¿«é€’ç«™å¤§å¸ˆçš„æ—¶ç©ºç®¡ç†æœ¯**
â€”â€”ç”¨"é€‰æ‹©æ€§è®°å¿†"ç ´è§£è‚¡ç¥¨é¢„æµ‹ç„å­¦

---

### â… . **æ™®é€šå¿«é€’ç«™çš„ç¾éš¾**
**åœºæ™¯è¿˜åŸ**ï¼š
æƒ³è±¡ä¸€ä¸ªæ•ˆç‡ä½ä¸‹çš„å¿«é€’ç«™ï¼š
- ç¬¬1å¤©ï¼šæ”¶åˆ°100ç®±ğŸ â†’ å…¨éƒ¨å †åœ¨ä»“åº“
- ç¬¬5å¤©ï¼šæ”¶åˆ°50ç®±ğŸ‡ â†’ è¢«è‹¹æœæ·¹æ²¡ï¼Œæ‰¾ä¸åˆ°è‘¡è„
- ç¬¬10å¤©ï¼šæ€¥éœ€æ‰¾è‘¡è„ â†’ åªèƒ½åœ¨è‹¹æœå±±é‡ŒæŒ–å‘€æŒ–

**RNNçš„å›°å¢ƒ**ï¼š
å¤„ç†æ—¶é—´åºåˆ—æ—¶å°±åƒè¿™ä¸ªç¬¨ä»“åº“ï¼š
- é‡è¦ä¿¡æ¯ï¼ˆè‘¡è„ï¼‰è¢«åç»­ä¿¡æ¯ï¼ˆè‹¹æœæµ·å•¸ï¼‰æ·¹æ²¡
- é•¿æœŸè®°å¿†èƒ½åŠ›â‰ˆé‡‘é±¼ï¼ˆåªæœ‰7ç§’è®°å¿†ï¼‰

**çµé­‚åæ§½**ï¼š
"æ™®é€šRNNçš„è®°å¿†åŠ›ï¼Œè¿å‰ä»»çš„åå­—éƒ½è®°ä¸ä½ï¼"

---

### â…¡. **LSTMå¿«é€’ç«™çš„ä¸‰é‡é—¨ç¦**
#### æ ¸å¿ƒé»‘ç§‘æŠ€ï¼šç”¨é—¨æ§å®ç°"è®°å¿†ç®¡ç†"
```
è®°å¿† = é€‰æ‹©æ€§é—å¿˜ + é‡ç‚¹è®°å¿† + æ™ºèƒ½è¾“å‡º
```
**å¿«é€’ç«™æ”¹é€ è®¡åˆ’**ï¼š
1. **å¿˜è®°é—¨ï¼ˆForget Gateï¼‰**
   - ä¿å®‰å¤§çˆ·æ‹¿ç€æ‰«ææªï¼š"è¿‡æœŸè‹¹æœï¼Ÿç»Ÿç»Ÿæ‰”æ‰ï¼"
   - å†³å®šå“ªäº›æ—§è®°å¿†éœ€è¦é—å¿˜ï¼ˆæ¯”å¦‚ä¸‰å¤©å‰çš„å¤©æ°”æ•°æ®ï¼‰

2. **è¾“å…¥é—¨ï¼ˆInput Gateï¼‰**
   - è´¨æ£€å‘˜å°å§å§ï¼š"æ–°åˆ°çš„è‘¡è„è¦ç‰¹æ®Šæ ‡è®°ï¼"
   - åˆ¤æ–­å“ªäº›æ–°ä¿¡æ¯å€¼å¾—è®°å½•ï¼ˆæ¯”å¦‚çªç„¶å‡ºç°çš„äº¤æ˜“å³°å€¼ï¼‰

3. **è¾“å‡ºé—¨ï¼ˆOutput Gateï¼‰**
   - æ‰“åŒ…ä¸“å‘˜ï¼š"æ ¹æ®è®¢å•ï¼Œåªå‘è‘¡è„ç»™å®¢æˆ·ï½"
   - æ§åˆ¶å½“å‰è¾“å‡ºä»€ä¹ˆä¿¡æ¯ï¼ˆæ¯”å¦‚é¢„æµ‹æ˜å¤©è‚¡ä»·ï¼‰

**æŠ€æœ¯æœ¯è¯­ç¿»è¯‘**ï¼š
- **ç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰**ï¼šä¼ é€å¸¦ä¸Šçš„è®°å¿†é›†è£…ç®±
- **éšè—çŠ¶æ€ï¼ˆHidden Stateï¼‰**ï¼šå½“å‰å¿«é€’ç«™çš„å·¥ä½œå¿«ç…§

---

### â…¢. **é—¨æ§æœºåˆ¶æ‹†è§£ï¼šè‚¡ç¥¨é¢„æµ‹å®æˆ˜**
#### ä»»åŠ¡ï¼šé¢„æµ‹è‹¹æœå…¬å¸è‚¡ä»·
**è¾“å…¥æ•°æ®**ï¼š
- è¿‡å»30å¤©è‚¡ä»· ğŸ“ˆ
- äº¤æ˜“é‡ ğŸ“Š
- æ¨ç‰¹æƒ…ç»ªæŒ‡æ•° ğŸ˜¡ğŸ˜ƒ

**LSTMå·¥ä½œæµ**ï¼š
```python
# ä¼ªä»£ç æ¼”ç¤ºï¼ˆæ¯ä¸ªæ—¶é—´æ­¥ï¼‰
def LSTM_cell(æ—§è®°å¿†, æ–°æ•°æ®):
    # ç¬¬ä¸€å…³ï¼šå¿˜è®°é—¨ç­›é€‰
    é—å¿˜ç¨‹åº¦ = sigmoid(æ—§è®°å¿† * W1 + æ–°æ•°æ® * U1 + b1)
    è¿‡æ»¤åçš„è®°å¿† = æ—§è®°å¿† * é—å¿˜ç¨‹åº¦  # ä¸¢æ‰80%çš„è¿‡æœŸæ–°é—»
  
    # ç¬¬äºŒå…³ï¼šè¾“å…¥é—¨è´¨æ£€
    æ–°ä¿¡æ¯å¼ºåº¦ = sigmoid(æ—§è®°å¿† * W2 + æ–°æ•°æ® * U2 + b2)
    å€™é€‰ä¿¡æ¯ = tanh(æ—§è®°å¿† * W3 + æ–°æ•°æ® * U3 + b3)
    æ›´æ–°åçš„è®°å¿† = è¿‡æ»¤åçš„è®°å¿† + æ–°ä¿¡æ¯å¼ºåº¦ * å€™é€‰ä¿¡æ¯  # åŠ å…¥é‡ç‚¹æ ‡è®°çš„è‘¡è„
  
    # ç¬¬ä¸‰å…³ï¼šè¾“å‡ºé—¨æ‰“åŒ…
    è¾“å‡ºå¼ºåº¦ = sigmoid(æ—§è®°å¿† * W4 + æ–°æ•°æ® * U4 + b4)
    éšè—çŠ¶æ€ = è¾“å‡ºå¼ºåº¦ * tanh(æ›´æ–°åçš„è®°å¿†)  # åªè¾“å‡ºå¯¹é¢„æµ‹æœ‰ç”¨çš„éƒ¨åˆ†
  
    return éšè—çŠ¶æ€, æ›´æ–°åçš„è®°å¿†
```

**ç°å®æ¯”å–»**ï¼š
- å½“é©¬æ–¯å…‹å‘æ¨ç‰¹å®£å¸ƒæ–°æŠ€æœ¯ â†’ è¾“å…¥é—¨ç«‹å³é«˜äº®æ ‡è®°
- é‡åˆ°å¸¸è§„è´¢æŠ¥æ—¥ â†’ å¿˜è®°é—¨è‡ªåŠ¨è¿‡æ»¤æ™®é€šæ³¢åŠ¨
- è¾“å‡ºæ—¶é‡ç‚¹ç»“åˆæŠ€æœ¯çªç ´å’Œäº¤æ˜“é‡å¼‚å¸¸ â†’ é¢„æµ‹æ˜æ—¥å¤§æ¶¨

---

### â…£. **å¯è§†åŒ–ï¼šè®°å¿†ä¼ é€å¸¦çš„é­”æ³•**
#### è®°å¿†æ›´æ–°æµç¨‹å›¾ç¤ºï¼š
```
[æ—§è®°å¿†é›†è£…ç®±] --(é—å¿˜é—¨æ‰«æ)--> ğŸš®ä¸¢å¼ƒ30%è¿‡æœŸä¿¡æ¯
                â†“
[æ–°æ•°æ®ä¼ é€å¸¦] --(è¾“å…¥é—¨è´´æ ‡ç­¾)--> ğŸ“Œæ ‡è®°20%å…³é”®æ•°æ®
                â†“
[åˆå¹¶æ›´æ–°] --> ğŸ†•æ–°é›†è£…ç®±ï¼ˆä¿ç•™70%æ—§è®°å¿†+20%æ–°é‡ç‚¹ï¼‰
                â†“
[è¾“å‡ºé—¨ç­›é€‰] --> ğŸ“¤åªæ”¾å‡º50%å†…å®¹ç»™å®¢æˆ·
```

**è‚¡ç¥¨é¢„æµ‹ç¤ºä¾‹**ï¼š
- ç¬¬1å¤©ï¼šè®°å¿†é‡ç‚¹ = åŸºæœ¬é¢æ•°æ®ï¼ˆ80%ï¼‰
- ç¬¬15å¤©ï¼šçªç°å¤§é¢å–å• â†’ æ–°é‡ç‚¹è¦†ç›–æ—§è®°å¿†50%
- ç¬¬30å¤©ï¼šè¾“å‡ºé¢„æµ‹æ—¶ â†’ ç»“åˆ20å¤©å‰çš„è´¢æŠ¥+æœ€æ–°å¼‚å¸¸äº¤æ˜“

---

### â…¤. **ä¸ºä»€ä¹ˆLSTMæ˜¯æ—¶é—´ç®¡ç†å¤§å¸ˆï¼Ÿ**
#### ä¸‰å¤§ç»æŠ€ï¼š
1. **é•¿æœŸè®°å¿†é‡‘é’Ÿç½©**
   - ç»†èƒçŠ¶æ€åƒé«˜é€Ÿå…¬è·¯ï¼Œæ¢¯åº¦å¯ä»¥ç•…é€šæ— é˜»ä¼ é€’100+æ—¶é—´æ­¥
   - å¯¹æ¯”RNNï¼šæ¢¯åº¦å°±åƒèµ°æ³¥æ³å±±è·¯ï¼Œèµ°5æ­¥å°±ç´¯è¶´äº†

2. **åŠ¨æ€è®°å¿†ä¼˜å…ˆçº§**
   - é‡è¦ä¿¡æ¯ï¼ˆå¦‚å¹¶è´­æ–°é—»ï¼‰è‡ªåŠ¨è·å¾—"è®°å¿†VIPå¡"
   - çç¢æ³¢åŠ¨ï¼ˆå¦‚æ—¥å¸¸æ¶¨è·Œ1%ï¼‰è¢«è‡ªåŠ¨é™æƒ

3. **æŠ—å¹²æ‰°èƒ½åŠ›MAX**
   - é‡åˆ°æ•°æ®å™ªå£°ï¼ˆæ¯”å¦‚å‡æ–°é—»ï¼‰ï¼š
     - å¿˜è®°é—¨å¿«é€Ÿå¯åŠ¨ â†’ ä¸¢å¼ƒå¯ç–‘ä¿¡æ¯
     - è¾“å‡ºé—¨ä¿å®ˆåº”å¯¹ â†’ ç»´æŒç¨³å®šé¢„æµ‹

**å‡¡å°”èµ›å‘è¨€**ï¼š
"ä¸æ˜¯æˆ‘ä»¬è®°æ€§å¥½ï¼Œæ˜¯æ™®é€šæ¨¡å‹çš„è®°æ€§å®åœ¨å¤ªå·®ï¼"

---

### â…¥. **æ‰©å±•åº”ç”¨ï¼šè®©LSTMé¢„æµ‹å¤©æ°”**
#### æ¡ˆä¾‹ï¼šé¢„æµ‹æ˜å¤©æ˜¯å¦ä¸‹é›¨ ğŸŒ§ï¸
1. **è¾“å…¥åºåˆ—**ï¼š
   - è¿‡å»7å¤©æ¹¿åº¦ã€æ°”å‹ã€é£é€Ÿ
   - çªå‘å°é£è­¦æŠ¥ï¼ˆéœ€è¦è¾“å…¥é—¨ç‰¹åˆ«å…³æ³¨ï¼‰

2. **é—¨æ§è¿ä½œ**ï¼š
   - å¿˜è®°é—¨ï¼šè‡ªåŠ¨å¿½ç•¥ä¸€å‘¨å‰çš„æ— å…³æ•°æ®
   - è¾“å…¥é—¨ï¼šé«˜äº®æ ‡è®°å°é£è­¦æŠ¥
   - è¾“å‡ºé—¨ï¼šç»“åˆæ°”å‹éª¤é™+é£é€Ÿé£™å‡ â†’ é¢„æµ‹å¤§é›¨

3. **ç»“æœå¯è§†åŒ–**ï¼š
   ![LSTMé™é›¨é¢„æµ‹](https://miro.medium.com/v2/resize:fit:1400/1*4R1JtC7Yq-ZZ7Z5LQDgANA.gif)

---

ğŸ¯ **è¯¾åä¸‰é—®**ï¼š
1. ä¸ºä»€ä¹ˆLSTMç”¨tanhå’Œsigmoidä¸¤ç§æ¿€æ´»å‡½æ•°ï¼Ÿ
   ï¼ˆç­”ï¼štanhç”¨æ¥è°ƒèŠ‚ä¿¡æ¯å¼ºåº¦åœ¨-1~1ï¼Œsigmoidç”¨æ¥åšäºŒé€‰ä¸€å¼€å…³ï¼‰

2. å¦‚æœæ‰€æœ‰å¿˜è®°é—¨éƒ½å…³é—­ä¼šæ€æ ·ï¼Ÿ
   ï¼ˆç­”ï¼šå˜æˆè®°å¿†æ°¸åŠ¨æœºï¼Œæ—§ä¿¡æ¯æ— é™ç´¯ç§¯ â†’ ç±»ä¼¼è¿‡æ‹Ÿåˆï¼‰

3. LSTMå’ŒTransformerè°æ›´æ“…é•¿é•¿åºåˆ—ï¼Ÿ
   ï¼ˆç­”ï¼šTransformerç†è®ºä¸Šæ›´é•¿ï¼Œä½†LSTMåœ¨å°æ•°æ®é›†æ›´æŠ—å™ªï¼‰

ğŸ”® **ç„å­¦æ€»ç»“**ï¼š
"LSTMå°±åƒä¸ªæ™ºèƒ½å¤‡å¿˜å½•ï¼Œè¯¥è®°çš„çº¹èº«ä¸å¿˜ï¼Œè¯¥å¿˜çš„ç§’åˆ å¹²å‡€ï¼"

```python
# å½©è›‹ï¼šç”¨Keraså®ç°è¿·ä½ LSTM
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

model = Sequential()
model.add(LSTM(64, input_shape=(30, 5)))  # è¾“å…¥30å¤©ï¼Œæ¯å¤©5ä¸ªç‰¹å¾
model.add(Dense(1, activation='sigmoid'))  # é¢„æµ‹æ¶¨è·Œ

model.compile(optimizer='adam', loss='mse')
# å¼€å§‹è®­ç»ƒ -> åç­‰æˆä¸ºè‚¡ç¥ï¼ˆè¯¯ï¼‰
```



```python
"""
ğŸš€ è‚¡ç¥¨é¢„æµ‹ã®é‡å­æ³¢åŠ¨é€Ÿè¯»ç‰ˆï¼ˆLSTMå®æˆ˜ï¼‰
è­¦å‘Šï¼šæœ¬ä»£ç æ— æ³•çœŸæ­£é¢„æµ‹è‚¡å¸‚ï¼Œä»…ä¾›å­¦ä¹ ç„å­¦ç‚¼ä¸¹æŠ€å·§
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense, Dropout
from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint

# ----------------------
# â… . æ•°æ®ç„å­¦é¢„å¤„ç†
# ----------------------
def load_stock_data(path='stock.csv'):
    """åŠ è½½è‚¡ç¥¨æ•°æ®ï¼ˆå‡è®¾CSVåŒ…å«æ—¥æœŸã€å¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æ”¶ç›˜ä»·ã€æˆäº¤é‡ï¼‰"""
    df = pd.read_csv(path)
    df['Date'] = pd.to_datetime(df['Date'])
    df = df.sort_values('Date').set_index('Date')
  
    # æ„é€ ç‰¹å¾ï¼šåŠ å…¥æ¬¡æ—¥æ³¢åŠ¨ç‡ï¼ˆé¢„æµ‹ç›®æ ‡ï¼‰
    df['next_day_change'] = df['Close'].pct_change().shift(-1)  # é¢„æµ‹ç›®æ ‡
    df.dropna(inplace=True)
  
    # é€‰æ‹©ç‰¹å¾ï¼šæ”¶ç›˜ä»·ã€æˆäº¤é‡ã€æ³¢åŠ¨ç‡
    features = df[['Close', 'Volume', 'next_day_change']]
    return features

# æ•°æ®å½’ä¸€åŒ–ï¼ˆLSTMçš„ç”Ÿå­˜å¿…éœ€å“ï¼‰
scaler = MinMaxScaler(feature_range=(-1, 1))
scaled_data = scaler.fit_transform(features)

# æ—¶é—´çª—å£åˆ‡å‰²ï¼ˆåˆ¶é€ æ—¶é—´åºåˆ—æ ·æœ¬ï¼‰
def create_dataset(data, time_steps=30):
    X, y = [], []
    for i in range(len(data)-time_steps-1):
        X.append(data[i:(i+time_steps), :])  # åŒ…å«æ‰€æœ‰ç‰¹å¾
        y.append(data[i+time_steps, -1])     # é¢„æµ‹æ¬¡æ—¥æ³¢åŠ¨ç‡
    return np.array(X), np.array(y)

time_steps = 30  # çœ‹è¿‡å»30å¤©
X, y = create_dataset(scaled_data, time_steps)

# æ•°æ®é›†æ‹†åˆ†ï¼ˆ80%è®­ç»ƒï¼Œ20%æµ‹è¯•ï¼‰
split = int(0.8*len(X))
X_train, X_test = X[:split], X[split:]
y_train, y_test = y[:split], y[split:]

# ----------------------
# â…¡. å»ºé€ LSTMé‡å­ç‚¼ä¸¹ç‚‰
# ----------------------
model = Sequential(name="LSTM_Stock_Prophet")

# ç¬¬ä¸€å±‚LSTMï¼ˆå¼€å¯è¿”å›åºåˆ—ä»¥å †å ï¼‰
model.add(LSTM(units=64, 
               return_sequences=True,
               input_shape=(X_train.shape[1], X_train.shape[2]),
               recurrent_dropout=0.2))  # é˜²æ­¢è®°å¿†è¿‡æ‹Ÿåˆ

# ç¬¬äºŒå±‚LSTMï¼ˆæå–é«˜é˜¶æ—¶é—´æ¨¡å¼ï¼‰
model.add(LSTM(units=32, 
               return_sequences=False))  # æœ€åä¸€å±‚ä¸è¿”å›åºåˆ—

# é˜²è¿‡æ‹Ÿåˆä¸‰ä»¶å¥—
model.add(Dropout(0.3))
model.add(Dense(16, activation='relu'))
model.add(Dropout(0.2))

# è¾“å‡ºå±‚ï¼ˆé¢„æµ‹æ¶¨è·Œå¹…åº¦ï¼‰
model.add(Dense(1, activation='tanh'))  # è¾“å‡ºèŒƒå›´[-1,1]å¯¹åº”æ¶¨è·Œå¹…

# ç¼–è¯‘æ¨¡å‹ï¼ˆä½¿ç”¨ç„å­¦ä¼˜åŒ–å™¨ï¼‰
model.compile(optimizer='adam', 
              loss='mse',
              metrics=['mae'])

# å›è°ƒå‡½æ•°ï¼ˆé˜²æ­¢èµ°ç«å…¥é­”ï¼‰
callbacks = [
    EarlyStopping(patience=15, monitor='val_loss'),  # æ—©åœæ³•
    ModelCheckpoint('best_model.h5', save_best_only=True)  # ä¿å­˜æœ€ä½³æ¨¡å‹
]

# ----------------------
# â…¢. å¼€å§‹æ—¶ç©ºç©¿è¶Šè®­ç»ƒ
# ----------------------
history = model.fit(
    X_train, y_train,
    epochs=100,
    batch_size=64,
    validation_split=0.2,
    callbacks=callbacks,
    verbose=1
)

# åŠ è½½æœ€ä½³æ¨¡å‹ï¼ˆé˜²æ­¢è®­ç»ƒè¿‡åº¦ï¼‰
model.load_weights('best_model.h5')

# ----------------------
# â…£. ç»“æœå¯è§†åŒ–ï¼ˆç„å­¦éªŒè¯ï¼‰
# ----------------------
# è®­ç»ƒæŸå¤±æ›²çº¿
plt.figure(figsize=(12, 6))
plt.plot(history.history['loss'], label='è®­ç»ƒé›†æŸå¤±')
plt.plot(history.history['val_loss'], label='éªŒè¯é›†æŸå¤±')
plt.title('æ¨¡å‹æŸå¤±é‡å­æ³¢åŠ¨æ›²çº¿')
plt.legend()
plt.show()

# é¢„æµ‹ vs çœŸå®å€¼å¯¹æ¯”
y_pred = model.predict(X_test)

# åå½’ä¸€åŒ–ï¼ˆä»æ³¢åŠ¨ç‡è½¬æ¢ä¸ºä»·æ ¼ï¼‰
def inverse_transform(y):
    """å°†é¢„æµ‹çš„æ³¢åŠ¨ç‡è½¬æ¢ä¸ºå®é™…ä»·æ ¼å˜åŒ–"""
    dummy_data = np.zeros((len(y), scaled_data.shape[1]))
    dummy_data[:, -1] = y  # æœ€åä¸€åˆ—æ˜¯æ³¢åŠ¨ç‡
    return scaler.inverse_transform(dummy_data)[:, -1]

real_prices = features.iloc[-len(y_test):]['Close'].values
predicted_changes = inverse_transform(y_pred.flatten())
predicted_prices = real_prices[0] * np.cumprod(1 + predicted_changes)  # ç´¯è®¡è®¡ç®—é¢„æµ‹ä»·æ ¼

# ç»˜åˆ¶ä»·æ ¼æ›²çº¿
plt.figure(figsize=(14, 7))
plt.plot(features.index[-len(y_test):], real_prices, label='çœŸå®ä»·æ ¼')
plt.plot(features.index[-len(y_test):], predicted_prices, label='é¢„è¨€ä»·æ ¼', alpha=0.7)
plt.title('é‡å­æ³¢åŠ¨é€Ÿè¯»æ³•é¢„æµ‹æ•ˆæœ')
plt.legend()
plt.xticks(rotation=45)
plt.show()

# ----------------------
# â…¤. ä½¿ç”¨æŒ‡å—ï¼ˆé‡è¦ï¼ï¼‰
# ----------------------
"""
1. æ•°æ®å‡†å¤‡ï¼šæ›¿æ¢è‡ªå·±çš„stock.csvæ–‡ä»¶ï¼Œéœ€è¦åŒ…å«æ—¥æœŸã€å¼€ç›˜ã€æœ€é«˜ã€æœ€ä½ã€æ”¶ç›˜ã€æˆäº¤é‡
2. ç‰¹å¾å·¥ç¨‹ï¼šå¯å°è¯•æ·»åŠ æ›´å¤šç‰¹å¾ï¼ˆå¦‚MACDã€RSIç­‰æŠ€æœ¯æŒ‡æ ‡ï¼‰
3. å‚æ•°è°ƒä¼˜ï¼šè°ƒæ•´time_stepsã€LSTMå±‚æ•°ã€Dropoutæ¯”ä¾‹
4. é£é™©è­¦å‘Šï¼šå®é™…äº¤æ˜“ä½¿ç”¨éœ€é…åˆæ­¢æŸç­–ç•¥ï¼Œæœ¬æ¨¡å‹é¢„æµ‹å‡†ç¡®ç‡å¯èƒ½ä½äº50%
"""
```

---

### ğŸ¯ ä»£ç äº®ç‚¹è§£æ
1. **æ•°æ®åŠ¨æ€å½’ä¸€åŒ–**ï¼šä½¿ç”¨`MinMaxScaler(-1, 1)`é€‚åº”æ¶¨è·Œå¹…çš„æ­£è´Ÿå€¼
2. **é˜²è¿‡æ‹Ÿåˆç»„åˆæŠ€**ï¼š
   - åŒDropoutå±‚ï¼ˆ0.3+0.2æ¦‚ç‡éšæœºå¤±æ´»ï¼‰
   - æ—©åœæ³•ï¼ˆè¿ç»­15è½®ä¸æ”¹è¿›åˆ™åœæ­¢ï¼‰
   - æ¨¡å‹æ£€æŸ¥ç‚¹ï¼ˆè‡ªåŠ¨ä¿å­˜æœ€ä½³ç‰ˆæœ¬ï¼‰
3. **ç»“æœå¯è§†åŒ–é­”æ³•**ï¼š
   - è®­ç»ƒæŸå¤±æ›²çº¿ â†’ ç›‘æ§æ¨¡å‹æ˜¯å¦èµ°ç«å…¥é­”
   - ä»·æ ¼å¯¹æ¯”å›¾ â†’ ç›´è§‚æ˜¾ç¤ºé¢„æµ‹ä¸ç°å®çš„å·®è·ï¼ˆé€šå¸¸æ˜¯é¸¿æ²Ÿï¼‰

---

### ğŸŒŸ æ‰©å±•æ”¹é€ å»ºè®®
- **åŠ å…¥æ³¨æ„åŠ›æœºåˆ¶**ï¼šè®©LSTMå­¦ä¼š"é‡ç‚¹ç›¯ç›˜"
  ```python
  from tensorflow.keras.layers import Attention
  # åœ¨LSTMå±‚åæ·»åŠ ...
  model.add(Attention()(query=lstm_output, value=lstm_output))
  ```
- **å¤šç©ºä¿¡å·ç”Ÿæˆ**ï¼šå½“é¢„æµ‹æ¶¨å¹…>2%æ—¶ä¹°å…¥ï¼Œè·Œå¹…>2%æ—¶å–å‡º
  ```python
  trading_signal = np.where(y_pred > 0.02, 1, np.where(y_pred < -0.02, -1, 0))
  ```
- **åŠ å…¥æ–°é—»æƒ…ç»ªåˆ†æ**ï¼šç”¨BERTå¤„ç†è´¢ç»æ–°é—»ä½œä¸ºé¢å¤–ç‰¹å¾

---

ğŸ”” é‡è¦æé†’ï¼šè‚¡å¸‚é¢„æµ‹æœ¬è´¨æ˜¯éšæœºè¿‡ç¨‹ï¼Œæœ¬ä»£ç ä»…ä¸ºæ¼”ç¤ºLSTMå·¥ä½œåŸç†ï¼Œå®é™…ä½¿ç”¨äºæŸæ¦‚ä¸è´Ÿè´£ï¼